# LinOTP + FreeRADIUS + PostgreSQL: 2FA-—Å–µ—Ä–≤–µ—Ä —Å RADIUS-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º

## üìå –û–ø–∏—Å–∞–Ω–∏–µ

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤–æ–µ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é —Ä–µ—à–µ–Ω–∏–µ –¥–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (2FA) —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º:

- **LinOTP** ‚Äî —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä —Ç–æ–∫–µ–Ω–æ–≤ –∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- **FreeRADIUS** ‚Äî –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å RADIUS –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å VPN, firewalls –∏ –¥—Ä.
- **PostgreSQL** ‚Äî —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏ –¥–∞–Ω–Ω—ã—Ö LinOTP
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–ª–∏–µ–Ω—Ç–∞, –Ω–∞–ø—Ä–∏–º–µ—Ä: **Check Point NGFW**, **OpenVPN**, **FortiGate** –∏ –¥—Ä.

–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å LDAP, —Ç–æ–∫–µ–Ω—ã HOTP/TOTP, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ, REST API.

---

## ‚öôÔ∏è –°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏ (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ Docker)

–§–∞–π–ª: `linotp+freeradius_install.sh`  
–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ LinOTP + FreeRADIUS + PostgreSQL –Ω–∞ **Debian 10/11**.

### üîÑ –ß—Ç–æ –¥–µ–ª–∞–µ—Ç —Å–∫—Ä–∏–ø—Ç:
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –û–°
- –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ PostgreSQL, LinOTP admin, IP –∫–ª–∏–µ–Ω—Ç–∞ RADIUS
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –Ω—É–∂–Ω—ã–µ –ø–∞–∫–µ—Ç—ã
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç:
  - PostgreSQL: —Å–æ–∑–¥–∞—ë—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –±–∞–∑—É
  - LinOTP: –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î, –∞–¥–º–∏–Ω –∞–∫–∫–∞—É–Ω—Ç
  - FreeRADIUS: –≤–∫–ª—é—á–∞–µ—Ç Perl-–º–æ–¥—É–ª—å, –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –∫–ª–∏–µ–Ω—Ç–∞ –∏ LinOTP –∫–∞–∫ backend

### üß™ –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:
- Debian 10 –∏–ª–∏ 11
- root-–¥–æ—Å—Ç—É–ø
- –í—ã—Ö–æ–¥ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç
- –ü–æ—Ä—Ç—ã 1812/1813/443 –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–≤–æ–±–æ–¥–Ω—ã

### ‚ñ∂Ô∏è –ó–∞–ø—É—Å–∫:

```bash
chmod +x install_linotp_radius.sh
./install_linotp_radius.sh
```

–°–∫—Ä–∏–ø—Ç –∑–∞–ø—Ä–æ—Å–∏—Ç:
- –ª–æ–≥–∏–Ω/–ø–∞—Ä–æ–ª—å –æ—Ç PostgreSQL
- –∏–º—è –±–∞–∑—ã
- IP LinOTP –∏ –∫–ª–∏–µ–Ω—Ç–∞
- –∏–º—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
- shared secret

---

## üê≥ –ü—Ä–æ–µ–∫—Ç –Ω–∞ Docker

–ü—Ä–æ–µ–∫—Ç –≤–∫–ª—é—á–∞–µ—Ç:
- `docker-compose.yml`
- `linotp/` ‚Äî Dockerfile, —Å–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- `freeradius/` ‚Äî Dockerfile, –∫–æ–Ω—Ñ–∏–≥–∏, Perl-–º–æ–¥—É–ª—å `radius_linotp.pm`

### üöÄ –ó–∞–ø—É—Å–∫:

```bash
docker compose up --build -d
```

### ‚ö†Ô∏è –ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º –ø—Ä–æ–≤–µ—Ä—å:
–§–∞–π–ª `docker-compose.yml`, —Å–µ–∫—Ü–∏—è `linotp.environment`:

```yaml
environment:
  DB_USER: linotp
  DB_PASS: adminpass
  DB_NAME: linotpdb
  DB_HOST: postgres
  ADMIN_USER: admin
  ADMIN_PASS: adminpass
```

### üõ†Ô∏è –ß—Ç–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- RADIUS –∫–ª–∏–µ–Ω—Ç (`clients.conf`)
- —Å–≤—è–∑–∫–∞ FreeRADIUS ‚Üî LinOTP —á–µ—Ä–µ–∑ Perl
- PostgreSQL –∏ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- –°–æ–∑–¥–∞—ë—Ç—Å—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä LinOTP
- Apache –Ω–∞ –ø–æ—Ä—Ç—É 443

### üßæ –ü–æ–¥—Ä–æ–±–Ω–µ–µ –≤:
- [`CONFIG_GUIDE.md`](CONFIG_GUIDE.md)
- [`linotp-architecture.drawio`](linotp-architecture.drawio) ‚Äî —Å—Ö–µ–º–∞ –ø–æ—Ç–æ–∫–æ–≤

---

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

–ü—Ä–æ–µ–∫—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ–¥ –ª–∏—Ü–µ–Ω–∑–∏–µ–π **GNU Affero General Public License v3.0**  
–°–º. —Ñ–∞–π–ª [`LICENSE`](LICENSE)
